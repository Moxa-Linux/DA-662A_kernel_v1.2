------------------------------------------------------------------------------

Building embedded Linux firmware for UC-8481-LX

-----------------------------------------------------------------------------
Following steps describe how to decompress and build the firmware for Moxa embedded platform

1.Host Operation System Requirements  (recommend)

	Debian 4.0, 5.0, 6.0 (on x86)
	Ubuntu 8.04, 8.10, 9.04, 9.10, 10.04, 10.10, 11.04, 11.10 (on x86)
 	
2. Install the developing enviornment

	Following compiling enironment and packages are needed for firmware
	making. you must install these packages on your Debian based 
	enviornment.

	$ apt-get install build-essential autoconf lynx libxml2 libxml2-dev btyacc libjpeg62 libjpeg-dev flex man2html bison libtool libncurses5-dev xmlto uboot-mkimage

3. Install the arm-linux cross compiler for source code making. 
You can check it in your cdrom or download it from Moxa supporting 
page, http://www.moxa.com/support/support_home.aspx.

	For UC-8481-LX install the toolchain

	$ sh /tmp/arm-linux_4.4.2-v4_Build_12032109.sh
	$ rm -f /tmp/arm-linux_4.4.2-v4_Build_12032109.sh
	$ export PATH="$/usr/local/arm-linux-4.4.2-v4/bin":$PATH

4. Untar the source code, stdlinux_uc8481.tar.bz2

	tar xjvf stdlinux_uc8481.tar.bz2
	
	After the stdlinux_uc8481.tar.bz2 is untared, 
	all the files will be decompressed in /PATH/TO/stdlinux_uc8481 directory
	
	./stdlinux_uc8481/linux-2.6.38.8	Linux kernel source code
	./stdlinux_uc8481/modules		Linux kernel modules (not included in kernel)
	./stdlinux_uc8481/user			Application source code
	./stdlinux_uc8481/lib			Library source code
	./stdlinux_uc8481/vendor/Moxa/		Product specific configurations
	./stdlinux_uc8481/host			Host utility
	./stdlinux_uc8481/tools			rom file making utilities
	./stdlinux_uc8481/config		firmware configuration files

5. Then you can enter the stdlinux_uc8481 directory and make the firmware image
	
	5.1. Select the Vendor/Product and Kernel/Libray in menuconfig

	$ cd /PATH/TO/stdlinux_uc8481
	$ make menuconfig

	5.1.a. Enter the Vendor/Product menu to select Moxa/uc8481

	--- Select the Vendor you wish to target
	(Moxa) Vendor
	--- Select the Product you wish to target
	(uc8481) Moxa Products

	5.1.b. Enter the Kernel/Library/Defaults Selection to select linux-2.6.38.8

	(linux-2.6.38.8) Kernel Version 
	--- Libc is None
	[ ] Default all settings (lose changes)
	[ ] Customize Kernel Settings (NEW)
	[ ] Customize Module Settings
	[ ] Customize Vendor/User Settings
	[ ] Update Default Vendor Settings

	5.2. make the linux kernel

	$ cd /PATH/TO/stdlinux_uc8481
	$ make linux

	the kennel image will be output to /tftpboot/zImage, you should create 
	/tftpboot directory before making zImage

	5.3. Fast making the firmware

	$ cd /PATH/TO/stdlinux_uc8481
	$ make fast_build

	the firmwares and image files will be output to /tftpboot/1.0_Build_12042605/

	8481/FWR_UC8481_V1.0_Build_12042605.hfm	the firmware
	8481/UC8481_R1-2.4-1.0_Build_12042605	the ROM1 image
	8481/UC8481_R2-2.4-1.0_Build_12042605	the ROM2 image
	uc8481-kernel-1.0.bin			the kernel image
	uc8481-usrdisk-1.0.dsk			the roof file system image
	
	You can upload the .hfm file to your target and upgrade by upgradehfm
	
	5.4. Rebuild all the source

	This will take a long time to rebuild all the libraries and applications. If not necessary, we suggest you should use the fast build making.

	$ cd /PATH/TO/stdlinux_uc8481
	$ make
	
