diff -Nru openssl-0.9.8r-orig/crypto/evp/evp_enc.c openssl-0.9.8r/crypto/evp/evp_enc.c
--- openssl-0.9.8r-orig/crypto/evp/evp_enc.c	2008-09-16 06:32:23.000000000 +0800
+++ openssl-0.9.8r/crypto/evp/evp_enc.c	2016-05-12 15:35:29.987152453 +0800
@@ -167,7 +167,7 @@
 	OPENSSL_assert(bl <= (int)sizeof(ctx->buf));
 	if (i != 0)
 		{
-		if (i+inl < bl)
+		if (bl - i > inl)
 			{
 			memcpy(&(ctx->buf[i]),in,inl);
 			ctx->buf_len+=inl;
