diff -up openssl-fips-0.9.8e/crypto/evp/encode.c.b64-underflow openssl-fips-0.9.8e/crypto/evp/encode.c
--- openssl-fips-0.9.8e/crypto/evp/encode.c.b64-underflow	2005-06-21 00:11:28.000000000 +0200
+++ openssl-fips-0.9.8e/crypto/evp/encode.c	2015-04-02 15:27:50.469940688 +0200
@@ -325,6 +325,7 @@ int EVP_DecodeUpdate(EVP_ENCODE_CTX *ctx
 				v=EVP_DecodeBlock(out,d,n);
 				n=0;
 				if (v < 0) { rv=0; goto end; }
+				if (eof > v) { rv=-1; goto end; }
 				ret+=(v-eof);
 				}
 			else
